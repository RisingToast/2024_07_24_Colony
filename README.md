# 2024_07_24_Colony
μ›λ³Έ νμ΄μ§€ : [https://docs.ultralytics.com/yolov5/tutorials/train_custom_data/]
> λ°‘μ λ‚΄μ©μ€ μ›λ³Έ νμ΄μ§€μ ν•κµ­μ–΄ λ²μ—­λ³Έμ…λ‹λ‹¤. <br>
λ²μ—­κΈ°λ¥Ό μ‚¬μ©ν–κΈ° λ•λ¬Έμ— μ •ν™•μ„±μ΄ λ–¨μ–΄μ§ μ μμµλ‹λ‹¤.

# μ‚¬μ©μ μ§€μ • λ°μ΄ν„° ν›λ ¨ν•κΈ°

μ΄ κ°€μ΄λ“μ—μ„λ” YOLOv5 π€λ¥Ό μ‚¬μ©ν•μ—¬ μ‚¬μ©μ μ§€μ • λ°μ΄ν„° μ„ΈνΈλ¥Ό ν›λ ¨ν•λ” λ°©λ²•μ„ μ„¤λ…ν•©λ‹λ‹¤.

μ‹μ‘ν•κΈ° μ „
PyTorch>=1.8μ„ ν¬ν•¨ν• Python>=3.8.0 ν™κ²½μ—μ„ μ €μ¥μ†λ¥Ό λ³µμ ν•κ³  μ”κµ¬μ‚¬ν•­.txtλ¥Ό μ„¤μΉν•©λ‹λ‹¤. λ¨λΈκ³Ό λ°μ΄ν„° μ„ΈνΈλ” μµμ‹  YOLOv5 λ¦΄λ¦¬μ¤μ—μ„ μλ™μΌλ΅ λ‹¤μ΄λ΅λ“λ©λ‹λ‹¤.

``` 
git clone https://github.com/ultralytics/yolov5  # clone
cd yolov5
pip install -r requirements.txt  # install
```
# μ‚¬μ©μ μ§€μ • λ°μ΄ν„°μ— λ€ν• κµμ΅

κ°μ²΄λ¥Ό κ°μ§€ν•λ” μ‚¬μ©μ μ§€μ • λ¨λΈμ„ λ§λ“λ” κ²ƒμ€ μ΄λ―Έμ§€λ¥Ό μμ§‘ λ° μ •λ¦¬ν•κ³ , κ΄€μ‹¬ κ°μ²΄μ— λ μ΄λΈ”μ„ μ§€μ •ν•κ³ , λ¨λΈμ„ ν•™μµμ‹ν‚¤κ³ , μ•Όμƒμ— λ°°ν¬ν•μ—¬ μμΈ΅μ„ μν–‰ν• λ‹¤μ, λ°°ν¬λ λ¨λΈμ„ μ‚¬μ©ν•μ—¬ μ—£μ§€ μ‚¬λ΅€μ μλ¥Ό μμ§‘ν•μ—¬ λ°λ³µ λ° κ°μ„ ν•λ” λ°λ³µμ μΈ ν”„λ΅μ„Έμ¤μ…λ‹λ‹¤.<br>

λΌμ΄μ„ μ¤<br>
Ultralyticsλ” λ‘ κ°€μ§€ λΌμ΄μ„ μ¤ μµμ…μ„ μ κ³µν•©λ‹λ‹¤:<br>
- ν•™μƒκ³Ό μ• νΈκ°€μ—κ² μ΄μƒμ μΈ μ¤ν” μ†μ¤ λΌμ΄μ„ μ¤μΈ AGPL-3.0 λΌμ΄μ„ μ¤.<br>

- μ—”ν„°ν”„λΌμ΄μ¦ λΌμ΄μ„ μ¤ - μ ν’ λ° μ„λΉ„μ¤μ— λ‹Ήμ‚¬μ AI λ¨λΈμ„ ν†µν•©ν•κ³ μ ν•λ” κΈ°μ—…μ„ μ„ν• λΌμ΄μ„ μ¤μ…λ‹λ‹¤.<br>
μμ„Έν• λ‚΄μ©μ€ μΈνΈλΌ μ• λ„λ¦¬ν‹±μ¤ λΌμ΄μ„ μ¤λ¥Ό μ°Έμ΅°ν•μ„Έμ”.<br>

ν•΄λ‹Ή λ°μ΄ν„°μ—μ„ κ°μ²΄μ ν΄λμ¤λ¥Ό ν•™μµν•λ ¤λ©΄ YOLOv5 λ¨λΈμ„ λ μ΄λΈ”μ΄ μ§€μ •λ λ°μ΄ν„°λ΅ ν•™μµν•΄μ•Ό ν•©λ‹λ‹¤. ν•™μµμ„ μ‹μ‘ν•κΈ° μ „μ— λ°μ΄ν„° μ„ΈνΈλ¥Ό λ§λ“λ” λ°λ” λ‘ κ°€μ§€ μµμ…μ΄ μμµλ‹λ‹¤:

# μµμ… 1: λ΅λ³΄ν”λ΅μ° λ°μ΄ν„° μ„ΈνΈ λ§λ“¤κΈ°

## 1.1 μ΄λ―Έμ§€ μμ§‘

λ¨λΈμ€ λ¨λ²”μ„ ν†µν•΄ ν•™μµν•©λ‹λ‹¤. 

μ‹¤μ μ™€ μ μ‚¬ν• μ΄λ―Έμ§€λ΅ ν›λ ¨ν•λ” κ²ƒμ΄ κ°€μ¥ μ¤‘μ”ν•©λ‹λ‹¤.<br> μµμΆ…μ μΌλ΅ ν”„λ΅μ νΈλ¥Ό λ°°ν¬ν•  λ•μ™€ λ™μΌν• κµ¬μ„±(μΉ΄λ©”λΌ, κ°λ„, μ΅°λ… λ“±)μΌλ΅ λ‹¤μ–‘ν• μ΄λ―Έμ§€λ¥Ό μμ§‘ν•λ” κ²ƒμ΄ κ°€μ¥ μ΄μƒμ μ…λ‹λ‹¤.<br>

μ΄κ²ƒμ΄ λ¶κ°€λ¥ν•λ‹¤λ©΄ κ³µκ° λ°μ΄ν„° μ„ΈνΈμ—μ„ μ‹μ‘ν•μ—¬ μ΄κΈ° λ¨λΈμ„ ν›λ ¨ν• λ‹¤μ μ¶”λ΅  μ¤‘μ— μ•Όμƒμ—μ„ μ΄λ―Έμ§€λ¥Ό μƒν”λ§ν•μ—¬ λ°μ΄ν„° μ„ΈνΈμ™€ λ¨λΈμ„ λ°λ³µμ μΌλ΅ κ°μ„ ν•  μ μμµλ‹λ‹¤.

## 1.2 λ μ΄λΈ” λ§λ“¤κΈ°

μ΄λ―Έμ§€λ¥Ό μμ§‘ν• ν›„μ—λ” κ΄€μ‹¬ μλ” κ°μ²΄μ— μ£Όμ„μ„ λ‹¬μ•„ λ¨λΈμ΄ ν•™μµν•  κ·Όκ±° μλ£λ¥Ό λ§λ“¤μ–΄μ•Ό ν•©λ‹λ‹¤.<br>
Roboflow Annotateλ” ν€κ³Ό ν•¨κ» μ΄λ―Έμ§€λ¥Ό κ΄€λ¦¬ν•κ³  λΌλ²¨μ„ λ¶™μ΄κ³  YOLOv5μ μ£Όμ„ ν•μ‹μΌλ΅ λ‚΄λ³΄λ‚΄κΈ° μ„ν• κ°„λ‹¨ν• μ›Ή κΈ°λ° ν΄μ…λ‹λ‹¤.

## 1.3 YOLOv5μ© λ°μ΄ν„° μ„ΈνΈ μ¤€λΉ„ν•κΈ°

μ΄λ―Έμ§€μ— Roboflowλ΅ λ μ΄λΈ”μ„ μ§€μ •ν•λ“  μ§€μ •ν•μ§€ μ•λ“ , λ°μ΄ν„° μ„ΈνΈλ¥Ό YOLO ν•μ‹μΌλ΅ λ³€ν™ν•κ³ , YOLOv5 YAML κµ¬μ„± νμΌμ„ μƒμ„±ν•κ³ , κµμ΅ μ¤ν¬λ¦½νΈλ΅ κ°€μ Έμ¬ μ μλ„λ΅ νΈμ¤ν…ν•λ” λ° μ‚¬μ©ν•  μ μμµλ‹λ‹¤.<br>
λ¬΄λ£ Roboflow κ³„μ •μ„ λ§λ“¤κ³  κ³µκ° μ›ν¬μ¤νμ΄μ¤μ— λ°μ΄ν„° μ„ΈνΈλ¥Ό μ—…λ΅λ“ν• λ‹¤μ, μ£Όμ„μ΄ μ—†λ” μ΄λ―Έμ§€μ— λΌλ²¨μ„ λ¶™μΈ λ‹¤μ, λ°μ΄ν„° μ„ΈνΈμ λ²„μ „μ„ μƒμ„±ν•κ³  λ‚΄λ³΄λ‚΄ YOLOv5 Pytorch ν•μ‹μΌλ΅ λ§λ“­λ‹λ‹¤.<br>
μ°Έκ³ : YOLOv5λ” ν›λ ¨ μ¤‘μ— μ¨λΌμΈ μ¦κ°•μ„ μν–‰ν•λ―€λ΅ YOLOv5λ¥Ό μ‚¬μ©ν• ν›λ ¨μ—λ” Roboflowμ—μ„ μ–΄λ–¤ μ¦κ°• λ‹¨κ³„λ„ μ μ©ν•μ§€ μ•λ” κ²ƒμ΄ μΆ‹μµλ‹λ‹¤. ν•μ§€λ§ λ‹¤μκ³Ό κ°™μ€ μ „μ²λ¦¬ λ‹¨κ³„λ¥Ό μ μ©ν•λ” κ²ƒμ΄ μΆ‹μµλ‹λ‹¤:<br>

**μλ™ λ°©ν–¥** - μ΄λ―Έμ§€μ—μ„ EXIF λ°©ν–¥μ„ μ κ±°ν•©λ‹λ‹¤.<br>
**ν¬κΈ° μ΅°μ •(λμ΄κΈ°)** - λ¨λΈμ μ •μ‚¬κ°ν• μ…λ ¥ ν¬κΈ°λ΅ μ΅°μ •ν•©λ‹λ‹¤(640x640μ΄ YOLOv5 κΈ°λ³Έκ°’).
λ²„μ „μ„ μƒμ„±ν•λ©΄ λ°μ΄ν„° μ„ΈνΈμ μ¤λƒ…μƒ·μ΄ μƒμ„±λλ―€λ΅ λ‚μ¤‘μ— μ΄λ―Έμ§€λ¥Ό λ” μ¶”κ°€ν•κ±°λ‚ κµ¬μ„±μ„ λ³€κ²½ν•λ”λΌλ„ μ–Έμ λ“ μ§€ λμ•„κ°€μ„ ν–¥ν›„ λ¨λΈ ν•™μµ μ‹¤ν–‰μ„ μ΄ λ²„μ „κ³Ό λΉ„κµν•  μ μμµλ‹λ‹¤.

λ²„μ „μ„ μƒμ„±ν•λ©΄ λ°μ΄ν„° μ„ΈνΈμ μ¤λƒ…μƒ·μ΄ μƒμ„±λλ―€λ΅ λ‚μ¤‘μ— μ΄λ―Έμ§€λ¥Ό λ” μ¶”κ°€ν•κ±°λ‚ κµ¬μ„±μ„ λ³€κ²½ν•λ”λΌλ„ μ–Έμ λ“ μ§€ λμ•„κ°€μ„ ν–¥ν›„ λ¨λΈ ν•™μµ μ‹¤ν–‰μ„ μ΄ λ²„μ „κ³Ό λΉ„κµν•  μ μμµλ‹λ‹¤.

YOLOv5 νμ΄ν† μΉ ν•μ‹μΌλ΅ λ‚΄λ³΄λ‚Έ λ‹¤μ μ¤λ‹ν«μ„ κµμ΅ μ¤ν¬λ¦½νΈλ‚ λ…ΈνΈλ¶μ— λ³µμ‚¬ν•μ—¬ λ°μ΄ν„° μ„ΈνΈλ¥Ό λ‹¤μ΄λ΅λ“ν•©λ‹λ‹¤.

# μµμ… 2: μλ™ λ°μ΄ν„° μ„ΈνΈ λ§λ“¤κΈ°

## 2.1 λ°μ΄ν„°μ„ΈνΈ.yaml λ§λ“¤κΈ°

COCO128μ€ COCO train2017μ μ²« 128κ° μ΄λ―Έμ§€λ΅ κµ¬μ„±λ μ‘μ€ νν† λ¦¬μ–Ό λ°μ΄ν„° μ„ΈνΈμ μμ‹μ…λ‹λ‹¤. 

μ΄ 128κ°μ μ΄λ―Έμ§€λ” ν›λ ¨ νμ΄ν”„λΌμΈμ΄ μ¤λ²„ν”Όν…μ΄ κ°€λ¥ν•μ§€ ν™•μΈν•κΈ° μ„ν•΄ ν›λ ¨κ³Ό κ²€μ¦ λ¨λ‘μ— μ‚¬μ©λ©λ‹λ‹¤. <br>
μ•„λμ— ν‘μ‹λ data/coco128.yamlμ€ 
1) λ°μ΄ν„° μ„ΈνΈ λ£¨νΈ λ””λ ‰ν† λ¦¬ κ²½λ΅μ™€ ν›λ ¨/val/ν…μ¤νΈ μ΄λ―Έμ§€ λ””λ ‰ν„°λ¦¬(λλ” μ΄λ―Έμ§€ κ²½λ΅κ°€ ν¬ν•¨λ *.txt νμΌ)μ μƒλ€ κ²½λ΅, 
2) ν΄λμ¤ μ΄λ¦„ μ‚¬μ „μ„ μ •μν•λ” λ°μ΄ν„° μ„ΈνΈ κµ¬μ„± νμΌμ…λ‹λ‹¤:
```python 
# Train/val/test sets as 1) dir: path/to/imgs, 2) file: path/to/imgs.txt, or 3) list: [path/to/imgs1, path/to/imgs2, ..]
path: ../datasets/coco128 # dataset root dir
train: images/train2017 # train images (relative to 'path') 128 images
val: images/train2017 # val images (relative to 'path') 128 images
test: # test images (optional)

# Classes (80 COCO classes)
names:
    0: person
    1: bicycle
    2: car
    # ...
    77: teddy bear
    78: hair drier
    79: toothbrush
```

## 2.2 λ μ΄λΈ” λ§λ“¤κΈ°
μ£Όμ„ λ„κµ¬λ¥Ό μ‚¬μ©ν•μ—¬ μ΄λ―Έμ§€μ— λΌλ²¨μ„ λ¶™μΈ ν›„ μ΄λ―Έμ§€λ‹Ή ν•λ‚μ *.txt νμΌμ„ μ‚¬μ©ν•μ—¬ λΌλ²¨μ„ YOLO ν•μ‹μΌλ΅ λ‚΄λ³΄λƒ…λ‹λ‹¤(μ΄λ―Έμ§€μ— κ°μ²΄κ°€ μ—†λ” κ²½μ° *.txt νμΌμ΄ ν•„μ”ν•μ§€ μ•μ). .txt νμΌ μ‚¬μ–‘μ€ λ‹¤μκ³Ό κ°™μµλ‹λ‹¤:
- κ°μ²΄λ‹Ή ν• ν–‰
- κ° ν–‰μ€ ν΄λμ¤ x_center y_center λ„λΉ„ λ†’μ΄ ν•μ‹μ…λ‹λ‹¤.
- μƒμ μΆν‘λ” μ •κ·ν™”λ xywh ν•μ‹(0μ—μ„ 1 μ‚¬μ΄)μ΄μ–΄μ•Ό ν•©λ‹λ‹¤. μƒμκ°€ ν”½μ…€ λ‹¨μ„μΈ κ²½μ° x_centerμ™€ λ„λΉ„λ¥Ό μ΄λ―Έμ§€ λ„λΉ„λ΅ λ‚λ„κ³ , y_centerμ™€ λ†’μ΄λ¥Ό μ΄λ―Έμ§€ λ†’μ΄λ΅ λ‚λ•λ‹λ‹¤.
- ν΄λμ¤ λ²νΈλ” μ μΈλ±μ‹±λ©λ‹λ‹¤(0λ¶€ν„° μ‹μ‘).

## 2.3 λ””λ ‰ν† λ¦¬ μ •λ¦¬

μ•„λ μμ‹μ— λ”°λΌ κΈ°μ°¨ λ° λ°Έ μ΄λ―Έμ§€μ™€ λ μ΄λΈ”μ„ κµ¬μ„±ν•©λ‹λ‹¤. YOLOv5λ” /coco128μ΄ /yolov5 λ””λ ‰ν† λ¦¬ μ†μ /datasets λ””λ ‰ν† λ¦¬ μ•μ— μλ‹¤κ³  κ°€μ •ν•©λ‹λ‹¤. YOLOv5λ” κ° μ΄λ―Έμ§€ κ²½λ΅μ—μ„ /μ΄λ―Έμ§€/μ λ§μ§€λ§‰ μΈμ¤ν„΄μ¤λ¥Ό /λΌλ²¨/λ΅ λ€μ²΄ν•μ—¬ κ° μ΄λ―Έμ§€μ— λ€ν• λΌλ²¨μ„ μλ™μΌλ΅ μ°Ύμµλ‹λ‹¤. μλ¥Ό λ“¤μ–΄
``` 
../datasets/coco128/images/im0.jpg  # image
../datasets/coco128/labels/im0.txt  # label
```

# 3. λ¨λΈ μ„ νƒ
ν›λ ¨μ„ μ‹μ‘ν•  μ‚¬μ „ ν›λ ¨λ λ¨λΈμ„ μ„ νƒν•©λ‹λ‹¤. μ—¬κΈ°μ„λ” λ‘ λ²μ§Έλ΅ μ‘κ³  λΉ λ¥Έ λ¨λΈμΈ YOLOv5sλ¥Ό μ„ νƒν•©λ‹λ‹¤. λ¨λ“  λ¨λΈμ— λ€ν• μ „μ²΄ λΉ„κµλ” README ν‘λ¥Ό μ°Έμ΅°ν•μ„Έμ”.<br>
[https://github.com/ultralytics/assets/releases/download/v0.0.0/model_comparison.png]

# 4. ν›λ ¨
λ°μ΄ν„° μ„ΈνΈ, λ°°μΉ ν¬κΈ°, μ΄λ―Έμ§€ ν¬κΈ°λ¥Ό μ§€μ •ν•κ³  μ‚¬μ „ ν•™μµλ --weights yolov5s.pt(κ¶μ¥) λλ” λ¬΄μ‘μ„λ΅ μ΄κΈ°ν™”λ --weights '' --cfg yolov5s.yaml(κ¶μ¥ν•μ§€ μ•μ)μ„ μ‚¬μ©ν•μ—¬ COCO128μ—μ„ YOLOv5s λ¨λΈμ„ ν•™μµν•©λ‹λ‹¤. μ‚¬μ „ ν•™μµλ κ°€μ¤‘μΉλ” μµμ‹  YOLOv5 λ¦΄λ¦¬μ¤μ—μ„ μλ™μΌλ΅ λ‹¤μ΄λ΅λ“λ©λ‹λ‹¤.
```
python train.py --img 640 --epochs 3 --data coco128.yaml --weights yolov5s.pt
```
λ¨λ“  ν›λ ¨ κ²°κ³Όλ” μ‹¤ν–‰ λ””λ ‰ν„°λ¦¬κ°€ μ¦κ°€ν•¨μ— λ”°λΌ runs/train/μ— μ €μ¥λ©λ‹λ‹¤(μ: runs/train/exp2, runs/train/exp3 λ“±). μμ„Έν• λ‚΄μ©μ€ νν† λ¦¬μ–Ό λ…ΈνΈλ¶μ νΈλ μ΄λ‹ μ„Ήμ…μ„ μ°Έμ΅°ν•μ„Έμ”.

# 5. μ‹κ°ν™”

### νμ„± λ΅κΉ… λ° μ‹κ°ν™” π μƒλ΅μ΄ κΈ°λ¥
μ΄μ  Cometμ΄ YOLOv5μ™€ μ™„μ „ν ν†µν•©λμ—μµλ‹λ‹¤. μ‹¤μ‹κ°„μΌλ΅ λ¨λΈ λ©”νΈλ¦­μ„ μ¶”μ  λ° μ‹κ°ν™”ν•κ³ , ν•μ΄νΌνλΌλ―Έν„°, λ°μ΄ν„° μ„ΈνΈ λ° λ¨λΈ μ²΄ν¬ν¬μΈνΈλ¥Ό μ €μ¥ν•κ³ , Comet μ‚¬μ©μ μ§€μ • ν¨λ„λ΅ λ¨λΈ μμΈ΅μ„ μ‹κ°ν™”ν•  μ μμµλ‹λ‹¤! Cometμ„ μ‚¬μ©ν•λ©΄ μ‘μ—… λ‚΄μ©μ„ λ†“μΉμ§€ μ•κ³  λ¨λ“  κ·λ¨μ ν€μ—μ„ κ²°κ³Όλ¥Ό μ‰½κ² κ³µμ ν•κ³  ν‘μ—…ν•  μ μμµλ‹λ‹¤!

μ‹μ‘μ€ κ°„λ‹¨ν•©λ‹λ‹¤:
```
pip install comet_ml  # 1. install
export COMET_API_KEY=<Your API Key>  # 2. paste API key
python train.py --img 640 --epochs 3 --data coco128.yaml --weights yolov5s.pt  # 3. train
```
μ΄ μ—°λ™μ—μ„ μ§€μ›λλ” λ¨λ“  Comet κΈ°λ¥μ— λ€ν•΄ μμ„Έν μ•μ•„λ³΄λ ¤λ©΄ Comet νν† λ¦¬μ–Όμ„ ν™•μΈν•μ„Έμ”. Cometμ— λ€ν•΄ μμ„Έν μ•μ•„λ³΄κ³  μ‹¶μΌμ‹λ‹¤λ©΄ μ„¤λ…μ„λ¥Ό μ°Έμ΅°ν•μ„Έμ”. λ¨Όμ € Comet Colab Notebookμ„ μ‚¬μ©ν•΄ λ³΄μ„Έμ”: 